% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/facetted_maps.R
\name{facetted_map_bins}
\alias{facetted_map_bins}
\title{Plot Faceted Choropleth Maps from sf Data with Discrete Bins}
\usage{
facetted_map_bins(
  data,
  fill_col,
  facet_col = NULL,
  facet_row = NULL,
  adm1_shp = NULL,
  fill_colors,
  title = NULL,
  subtitle = NULL,
  fill_label = NULL,
  ncol = 3,
  output_file = NULL,
  width = 7,
  height = 10,
  dpi = 300,
  scale = 1,
  title_size = 14,
  subtitle_size = 11,
  legend_title_size = 10,
  compress_image = TRUE
)
}
\arguments{
\item{data}{An \code{sf} object containing geometries and attributes to plot.
Must include the columns specified in \code{fill_col} and \code{facet_col}.}

\item{fill_col}{Character scalar. Name of the column in \code{data} used for
polygon fill. This column should be a factor or character vector with
levels matching \code{fill_colors}.}

\item{facet_col}{Optional character scalar. Name of the column used for
faceting columns, typically a time variable such as \code{year}. When \code{NULL},
no faceting is applied and a single map is produced. Default is \code{NULL}.}

\item{facet_row}{Optional character scalar. Name of the column used for
faceting rows. When provided, the function uses \code{facet_grid(row ~ col)}
instead of \code{facet_wrap()}. Default is \code{NULL}.}

\item{adm1_shp}{Optional \code{sf} object containing higher-level administrative
boundaries (e.g. ADM1). When provided, boundaries are overlaid as thin
black outlines. Default is \code{NULL}.}

\item{fill_colors}{Named character vector of colors. Names must correspond
exactly to the levels in \code{fill_col}. Colors should be hex codes.}

\item{title}{Optional character scalar. Plot title. Default is \code{NULL}
(no title).}

\item{subtitle}{Optional character scalar. Plot subtitle. Default is
\code{NULL} (no subtitle).}

\item{fill_label}{Optional character scalar. Legend title for the fill
scale. Default is \code{NULL} (no legend title).}

\item{ncol}{Integer. Number of columns in the facet layout. Only used when
\code{facet_row} is \code{NULL} (i.e., when using \code{facet_wrap()}). Default is \code{3}.}

\item{output_file}{Optional character scalar. File path where the plot
should be saved. If \code{NULL}, the plot is not saved to disk.}

\item{width}{Numeric. Width of the saved plot in inches. Default is \code{7}.}

\item{height}{Numeric. Height of the saved plot in inches. Default is \code{10}.}

\item{dpi}{Numeric. Resolution (dots per inch) for saved output.
Default is \code{300}.}

\item{scale}{Numeric. Scaling factor for the plot. Values greater than 1
make text and elements relatively smaller; values less than 1 make them
larger. Default is \code{1}.}

\item{title_size}{Numeric. Font size for the plot title. Default is \code{14}.}

\item{subtitle_size}{Numeric. Font size for the plot subtitle. Default
is \code{11}.}

\item{legend_title_size}{Numeric. Font size for the legend title.
Default is \code{10}.}

\item{compress_image}{Logical. Compress PNG using \code{compress_png()} after
saving. Defaults to TRUE.}
}
\value{
A \code{ggplot} object. If \code{output_file} is provided, the plot is also written
to disk using \code{ggsave()}.
}
\description{
Creates a faceted choropleth map from an \code{sf} object using a binned
categorical variable for fill colors. The function is designed for
programmatic mapping of indicators over space and time, with optional
administrative boundary overlays and optional file export.

The function assumes that the fill variable is already discretised
(e.g. incidence bins, prevalence bins, rate categories) and mapped
explicitly to colors via \code{fill_colors}.

Typical use cases include:
\itemize{
\item Mapping crude or adjusted incidence by district over multiple years
\item Visualising binned prevalence or coverage indicators
\item Producing consistent, publication-ready spatial outputs
}
}
\details{
\itemize{
\item Uses \code{geom_sf()} for spatial rendering.
\item Uses \code{scale_fill_manual()} with explicit legend control to ensure
consistent color interpretation across plots.
\item Faceting is implemented via \code{facet_wrap()} using a dynamically
constructed formula.
\item The function does not perform binning internally. All binning logic
should be applied upstream.
}
}
\examples{
\dontrun{
# example incidence color scale (cases per 1,000 population)
incidence_colors <- c(
  "0-5"       = "#c6dbef",
  "5-50"      = "#9ecae1",
  "50-100"    = "#4292c6",
  "100-250"   = "#fb6a4a",
  "250-500"   = "#cb181d",
  "500-5,000" = "#7f0000"
)

facetted_map_bins(
  data = incidence_shp,
  fill_col = "n1_incidence_bin",
  facet_col = "year",
  adm1_shp = shp_file$adm1,
  fill_colors = incidence_colors,
  title = "Crude Malaria Incidence by District (ADM2), Burundi",
  subtitle = "All-age crude incidence aggregated annually",
  fill_label = "Cases per 1,000 population",
  ncol = 3,
  output_file = here::here(
    "outputs",
    "burundi_crude_incidence.png"
  )
)
}

}
