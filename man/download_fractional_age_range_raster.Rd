% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/download_worldpop_rasters.R
\name{download_fractional_age_range_raster}
\alias{download_fractional_age_range_raster}
\title{Download and Process WorldPop Age Range Raster Data with Fractional Age
Bands}
\usage{
download_fractional_age_range_raster(
  iso3,
  years,
  age_range = c(2, 10),
  out_dir = "."
)
}
\arguments{
\item{iso3}{Character string. Three-letter ISO country code (e.g., "TUN")}

\item{years}{Numeric vector. Years for which to download data. Note that
currently only 2020 data is available but will be used as base for other
years}

\item{age_range}{Numeric vector of length 2 specifying the [lower, upper]
age range bounds. Default: c(2, 10)}

\item{out_dir}{Character string. Directory where downloaded and processed
files will be saved. Default is current directory (".")}
}
\value{
No return value. Files are saved with naming pattern:
\code{iso3_lo_total_covered_lower_covered_upper_yr.tif} where:
\itemize{
\item iso3_lo: lowercase country code (e.g. "tun")
\item covered_lower: lower age bound with leading zeros (e.g. "02")
\item covered_upper: upper age bound with leading zeros (e.g. "10")
\item yr: year (e.g. "2020")
}
}
\description{
This function downloads WorldPop age/sex structure raster data and processes
it to extract precise age ranges by calculating fractional contributions from
overlapping age bands. For example, to get ages 2-10, it will take partial
contributions from the 1-5 and 5-10 bands.
}
\details{
\subsection{Data Source}{

This function connects to the WorldPop Unconstrained 1km Age-Sex Structured
Population dataset, publicly available at:

"https://data.worldpop.org/GIS/AgeSex_structures/
Global_2000_2020_1km/unconstrained"
}

\subsection{Overview}{

The function processes data in several steps:
\enumerate{
\item Identifies which WorldPop age bands overlap with the requested age range
\item Calculates the fraction needed from each overlapping band
(e.g., for age 2, it takes 3/4 of the 1-5 band)
\item Downloads 1km resolution raster files for required age bands and both
sexes
\item Applies calculated fractions to each band
\item Combines all bands and both sexes into a single raster
}

The age bands in WorldPop data are:
0-1, 1-5, 5-10, 10-15, ..., 75-80, 80+

Files are cached in the output directory to avoid repeated downloads. The
function will use cached files if they exist.
}
}
\examples{
\dontrun{
# Download Tunisia data for ages 2-10 for year 2020
# This will use fractions of the 1-5, 5-10, and 10-15 bands
download_fractional_age_range_raster(
  "TUN", 2020, c(2, 10), "data/worldpop"
)

# Download data for ages 0-15 (exact band boundaries)
download_fractional_age_range_raster(
  "TUN", 2020:2025, c(0, 15), "data/worldpop"
)
}
}
