% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ahadi_filepaths.R
\name{ahadi_path}
\alias{ahadi_path}
\title{Resolve path inside AHADI OneDrive shared library}
\usage{
ahadi_path(
  relative = NULL,
  org = "Applied Health Analytics for Delivery and Innovation Inc",
  library = "AHADI Information - technical",
  base = "Documentation per topic/data/dhs_data",
  refresh = FALSE,
  verbose = FALSE
)
}
\arguments{
\item{relative}{character. Relative path inside \code{base}. If \code{NULL}, the
function returns the resolved \code{base} folder path.}

\item{org}{character. Organisation name as it appears in OneDrive shared
library naming. This is cleaned internally for matching. Default is
"Applied Health Analytics for Delivery and Innovation Inc".}

\item{library}{character. Display name of the OneDrive shared library.
Example: "AHADI Information - technical".}

\item{base}{character. Base folder inside the library. Example:
"Documentation per topic/data/dhs_data".}

\item{refresh}{logical. If \code{TRUE}, ignores any cached location and forces
a fresh search.}

\item{verbose}{logical. If \code{TRUE}, prints diagnostic messages about how
the path was resolved.}
}
\value{
A character scalar giving an absolute path. If \code{relative} is \code{NULL}, this
is the resolved \code{base} path. Otherwise it is \code{file.path(base, relative)}.
}
\description{
\code{ahadi_path()} builds a robust, OS-aware path to a file or folder inside
the AHADI OneDrive "Shared Library". It:
\itemize{
\item detects the OS (Windows or macOS)
\item scans common OneDrive roots (including CloudStorage on macOS)
\item finds the "Shared Libraries" folder for the given organisation
\item fuzzy-matches the requested library name
\item navigates to a given base folder inside that library
\item optionally joins a relative path
}

The function caches the resolved library root in an R option so that
subsequent calls are fast. Use \code{refresh = TRUE} to force re-detection.
}
\details{
The detection logic follows several steps:
\itemize{
\item detect OS using \code{Sys.info()[["sysname"]]}
\item construct a list of candidate OneDrive root folders
\item within each root, look for folders whose names suggest a OneDrive
"Shared Libraries" mount
\item inside those, fuzzy match the requested organisation and library names
\item construct and validate the requested \code{base} folder
}

Matching is done on "cleaned" names (lowercase, no spaces or punctuation).
This makes the function resilient to cosmetic differences in naming such
as "AHADI Information - technical" vs "AHADI information (technical)".

If the function cannot find a matching organisation, library, or base
folder, it fails with \code{cli::cli_abort()} and prints the closest matches
it could see.
}
\examples{
\dontrun{
# get the base DHS data directory
base_path <- ahadi_path()

# get a specific file inside the base folder
file_path <- ahadi_path("surveys/2020/survey_data.csv")

# use a different library and base folder
other_path <- ahadi_path(
  relative = "my_file.xlsx",
  library = "AHADI Operations",
  base = "SOPs"
)

# force re-detection if the OneDrive setup changed
ahadi_path(refresh = TRUE, verbose = TRUE)
}

}
