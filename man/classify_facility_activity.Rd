% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/facility_reporting_plot.R
\name{classify_facility_activity}
\alias{classify_facility_activity}
\title{Classify health facility activity status by reporting behaviour}
\usage{
classify_facility_activity(
  data,
  hf_col,
  date_col = "date",
  key_indicators = c("test", "pres", "conf"),
  binary_classification = FALSE
)
}
\arguments{
\item{data}{Data frame containing routine health facility records.}

\item{hf_col}{Character. Column storing health facility identifiers.}

\item{date_col}{Character. Column storing observation dates. Defaults to
"date".}

\item{key_indicators}{Character vector with columns defining reporting
activity. Defaults to \code{c("test", "pres", "conf")}.}

\item{binary_classification}{Logical. If TRUE, returns binary classification
("Active", "Non-Active") instead of three-level classification. Defaults to
FALSE.}
}
\value{
Data frame with original columns plus:
\describe{
\item{reported_any}{Logical. TRUE if any key indicator was reported
that month.}
\item{first_reporting_date}{Date. First month the facility reported
any key indicator.}
\item{has_ever_reported}{Logical. TRUE if facility has reported at
least once up to this month.}
\item{activity_status}{Factor. One of "Active Reporting",
"Active Facility - Not Reporting", or "Inactive Facility" when
binary_classification = FALSE. When binary_classification = TRUE,
one of "Active" or "Non-Active".}
}
}
\description{
Builds a balanced monthly panel for all facilities and months, flags
reporting on key indicators, and classifies each facility-month into an
activity status: "Active Reporting", "Active Facility - Not Reporting",
or "Inactive Facility".
}
\details{
Activity status logic:
\itemize{
\item \strong{Active Reporting}: Facility reported at least one key indicator
in that month.
\item \strong{Active Facility - Not Reporting}: Facility has reported before
but did not report in that month.
\item \strong{Inactive Facility}: Facility has never reported any key indicator.
}

When binary_classification = TRUE:
\itemize{
\item \strong{Active}: Facility reported at least one key indicator in that month
(equivalent to "Active Reporting").
\item \strong{Non-Active}: Facility did not report in that month, regardless of
past reporting history (combines "Active Facility - Not Reporting" and
"Inactive Facility").
}
}
\examples{
toy_data <- tibble::tibble(
  hf_uid = rep(c("HF1", "HF2"), each = 4),
  date = rep(
    base::seq.Date(
      base::as.Date("2024-01-01"),
      by = "month",
      length.out = 4
    ),
    times = 2
  ),
  test = c(NA, 1, 2, NA, NA, NA, 3, 4),
  pres = c(0, 2, NA, 1, NA, 1, 2, 3),
  conf = c(0, NA, 1, 0, NA, NA, 1, 2)
)

classified <- classify_facility_activity(
  data = toy_data,
  hf_col = "hf_uid",
  key_indicators = c("test", "pres", "conf")
)

table(classified$activity_status)

# Binary classification example
classified_binary <- classify_facility_activity(
  data = toy_data,
  hf_col = "hf_uid",
  key_indicators = c("test", "pres", "conf"),
  binary_classification = TRUE
)

table(classified_binary$activity_status)
}
